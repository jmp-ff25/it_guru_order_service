-- =====================================================
-- IT Guru Order Service - –¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
-- =====================================================
-- –≠—Ç–æ—Ç —Å–∫—Ä–∏–ø—Ç –∑–∞–≥—Ä—É–∂–∞–µ—Ç mock-–¥–∞–Ω–Ω—ã–µ –≤ –ø—É—Å—Ç—É—é –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö
-- –ø–æ—Å–ª–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –º–∏–≥—Ä–∞—Ü–∏–π –¥–ª—è —Ü–µ–ª–µ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
-- =====================================================

-- –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ —Ç–∞–±–ª–∏—Ü—ã –ø—É—Å—Ç—ã–µ (–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å)
DO $$
BEGIN
    IF EXISTS (
        SELECT 1 FROM categories 
        UNION ALL
        SELECT 1 FROM nomenclature 
        UNION ALL  
        SELECT 1 FROM client
        UNION ALL
        SELECT 1 FROM "order"
    ) THEN
        RAISE EXCEPTION '–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö —É–∂–µ —Å–æ–¥–µ—Ä–∂–∏—Ç –¥–∞–Ω–Ω—ã–µ! –≠—Ç–æ—Ç —Å–∫—Ä–∏–ø—Ç –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω —Ç–æ–ª—å–∫–æ –¥–ª—è –ø—É—Å—Ç—ã—Ö —Ç–∞–±–ª–∏—Ü.';
    END IF;
END $$;

-- –ù–∞—á–∏–Ω–∞–µ–º —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é
BEGIN;

-- =====================================================
-- –ö–ê–¢–ï–ì–û–†–ò–ò –¢–û–í–ê–†–û–í (–∏–µ—Ä–∞—Ä—Ö–∏—è)
-- =====================================================

-- –ö–æ—Ä–Ω–µ–≤—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
INSERT INTO categories (id, name, parent_id, slug) VALUES
    (1, '–≠–ª–µ–∫—Ç—Ä–æ–Ω–∏–∫–∞', NULL, 'electronics'),
    (2, '–û–¥–µ–∂–¥–∞', NULL, 'clothing'), 
    (3, '–ö–Ω–∏–≥–∏', NULL, 'books');

-- –ü–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏–∏ —ç–ª–µ–∫—Ç—Ä–æ–Ω–∏–∫–∏
INSERT INTO categories (id, name, parent_id, slug) VALUES
    (4, '–°–º–∞—Ä—Ç—Ñ–æ–Ω—ã', 1, 'smartphones'),
    (5, '–ù–æ—É—Ç–±—É–∫–∏', 1, 'laptops'),
    (6, '–ù–∞—É—à–Ω–∏–∫–∏', 1, 'headphones');

-- –ü–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –æ–¥–µ–∂–¥—ã
INSERT INTO categories (id, name, parent_id, slug) VALUES
    (7, '–ú—É–∂—Å–∫–∞—è –æ–¥–µ–∂–¥–∞', 2, 'mens-clothing'),
    (8, '–ñ–µ–Ω—Å–∫–∞—è –æ–¥–µ–∂–¥–∞', 2, 'womens-clothing');

-- –ü–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –∫–Ω–∏–≥
INSERT INTO categories (id, name, parent_id, slug) VALUES
    (9, '–•—É–¥–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω–∞—è –ª–∏—Ç–µ—Ä–∞—Ç—É—Ä–∞', 3, 'fiction'),
    (10, '–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –ª–∏—Ç–µ—Ä–∞—Ç—É—Ä–∞', 3, 'technical');

-- –û–±–Ω–æ–≤–ª—è–µ–º –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –¥–ª—è categories
SELECT setval('categories_id_seq', (SELECT MAX(id) FROM categories));

-- =====================================================
-- –ù–û–ú–ï–ù–ö–õ–ê–¢–£–†–ê (—Ç–æ–≤–∞—Ä—ã)
-- =====================================================

-- –°–º–∞—Ä—Ç—Ñ–æ–Ω—ã
INSERT INTO nomenclature (id, sku, name, price, quantity) VALUES
    (1, 'PHONE001', 'iPhone 15 Pro', 99999.99, 10),
    (2, 'PHONE002', 'Samsung Galaxy S24', 79999.99, 15),
    (3, 'PHONE003', 'Xiaomi 14', 49999.99, 25);

-- –ù–æ—É—Ç–±—É–∫–∏
INSERT INTO nomenclature (id, sku, name, price, quantity) VALUES
    (4, 'LAPTOP001', 'MacBook Pro 16"', 299999.99, 5),
    (5, 'LAPTOP002', 'Dell XPS 13', 149999.99, 8),
    (6, 'LAPTOP003', 'Lenovo ThinkPad X1', 179999.99, 12);

-- –ù–∞—É—à–Ω–∏–∫–∏
INSERT INTO nomenclature (id, sku, name, price, quantity) VALUES
    (7, 'AUDIO001', 'AirPods Pro', 24999.99, 30),
    (8, 'AUDIO002', 'Sony WH-1000XM5', 34999.99, 20);

-- –û–¥–µ–∂–¥–∞
INSERT INTO nomenclature (id, sku, name, price, quantity) VALUES
    (9, 'CLOTH001', '–§—É—Ç–±–æ–ª–∫–∞ –±–∞–∑–æ–≤–∞—è', 1999.99, 100),
    (10, 'CLOTH002', '–î–∂–∏–Ω—Å—ã –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–µ', 4999.99, 50),
    (11, 'CLOTH003', '–ü–ª–∞—Ç—å–µ –ª–µ—Ç–Ω–µ–µ', 3999.99, 40);

-- –ö–Ω–∏–≥–∏  
INSERT INTO nomenclature (id, sku, name, price, quantity) VALUES
    (12, 'BOOK001', 'Python. –ß–∏—Å—Ç—ã–π –∫–æ–¥', 2999.99, 30),
    (13, 'BOOK002', '–í–æ–π–Ω–∞ –∏ –º–∏—Ä', 1499.99, 25),
    (14, 'BOOK003', '–ê–ª–≥–æ—Ä–∏—Ç–º—ã. –í–≤–æ–¥–Ω—ã–π –∫—É—Ä—Å', 3499.99, 20);

-- –û–±–Ω–æ–≤–ª—è–µ–º –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –¥–ª—è nomenclature
SELECT setval('nomenclature_id_seq', (SELECT MAX(id) FROM nomenclature));

-- =====================================================
-- –°–í–Ø–ó–ò –¢–û–í–ê–†–´-–ö–ê–¢–ï–ì–û–†–ò–ò (M:N)
-- =====================================================

INSERT INTO nomenclature_categories (nomenclature_id, category_id) VALUES
    -- –°–º–∞—Ä—Ç—Ñ–æ–Ω—ã
    (1, 4), (2, 4), (3, 4),
    -- –ù–æ—É—Ç–±—É–∫–∏  
    (4, 5), (5, 5), (6, 5),
    -- –ù–∞—É—à–Ω–∏–∫–∏
    (7, 6), (8, 6),
    -- –ú—É–∂—Å–∫–∞—è –æ–¥–µ–∂–¥–∞
    (9, 7), (10, 7),
    -- –ñ–µ–Ω—Å–∫–∞—è –æ–¥–µ–∂–¥–∞ (—Ñ—É—Ç–±–æ–ª–∫–∞ —Ç–∞–∫–∂–µ –≤ –º—É–∂—Å–∫–æ–π)
    (11, 8), (9, 8),
    -- –ö–Ω–∏–≥–∏
    (12, 10), (14, 10), (13, 9);

-- =====================================================  
-- –ö–õ–ò–ï–ù–¢–´
-- =====================================================

INSERT INTO client (id, name, address) VALUES
    (1, '–ò–≤–∞–Ω –ü–µ—Ç—Ä–æ–≤', '–≥. –ú–æ—Å–∫–≤–∞, —É–ª. –¢–≤–µ—Ä—Å–∫–∞—è, –¥. 15, –∫–≤. 42'),
    (2, '–ú–∞—Ä–∏—è –°–∏–¥–æ—Ä–æ–≤–∞', '–≥. –°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥, –ø—Ä. –ù–µ–≤—Å–∫–∏–π, –¥. 28, –∫–≤. 15'),
    (3, '–ê–ª–µ–∫—Å–µ–π –ö–æ–∑–ª–æ–≤', '–≥. –ï–∫–∞—Ç–µ—Ä–∏–Ω–±—É—Ä–≥, —É–ª. –õ–µ–Ω–∏–Ω–∞, –¥. 45, –∫–≤. 78'),
    (4, '–û–ª—å–≥–∞ –í–æ–ª–∫–æ–≤–∞', '–≥. –ù–∏–∂–Ω–∏–π –ù–æ–≤–≥–æ—Ä–æ–¥, —É–ª. –ì–æ—Ä—å–∫–æ–≥–æ, –¥. 12, –∫–≤. 33'),
    (5, '–î–º–∏—Ç—Ä–∏–π –°–º–∏—Ä–Ω–æ–≤', '–≥. –ö–∞–∑–∞–Ω—å, —É–ª. –ë–∞—É–º–∞–Ω–∞, –¥. 67, –∫–≤. 21');

-- –û–±–Ω–æ–≤–ª—è–µ–º –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –¥–ª—è client
SELECT setval('client_id_seq', (SELECT MAX(id) FROM client));

-- =====================================================
-- –ó–ê–ö–ê–ó–´
-- =====================================================

INSERT INTO "order" (id, client_id, status) VALUES
    (1, 1, 'created'),   -- –ò–≤–∞–Ω –ü–µ—Ç—Ä–æ–≤ - —Å–æ–∑–¥–∞–Ω
    (2, 2, 'paid'),      -- –ú–∞—Ä–∏—è –°–∏–¥–æ—Ä–æ–≤–∞ - –æ–ø–ª–∞—á–µ–Ω  
    (3, 3, 'shipped');   -- –ê–ª–µ–∫—Å–µ–π –ö–æ–∑–ª–æ–≤ - –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω

-- –û–±–Ω–æ–≤–ª—è–µ–º –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –¥–ª—è order
SELECT setval('order_id_seq', (SELECT MAX(id) FROM "order"));

-- =====================================================
-- –ü–û–ó–ò–¶–ò–ò –ó–ê–ö–ê–ó–û–í
-- =====================================================

INSERT INTO orderitem (id, order_id, nomenclature_id, quantity, price_at_order) VALUES
    -- –ó–∞–∫–∞–∑ 1: –ò–≤–∞–Ω –ø–æ–∫—É–ø–∞–µ—Ç iPhone + AirPods
    (1, 1, 1, 1, 99999.99),   -- iPhone 15 Pro
    (2, 1, 7, 1, 24999.99),   -- AirPods Pro
    
    -- –ó–∞–∫–∞–∑ 2: –ú–∞—Ä–∏—è –ø–æ–∫—É–ø–∞–µ—Ç –Ω–æ—É—Ç–±—É–∫ + –∫–Ω–∏–≥—É  
    (3, 2, 5, 1, 149999.99),  -- Dell XPS 13
    (4, 2, 12, 2, 2999.99),   -- Python –∫–Ω–∏–≥–∞ x2
    
    -- –ó–∞–∫–∞–∑ 3: –ê–ª–µ–∫—Å–µ–π –ø–æ–∫—É–ø–∞–µ—Ç –æ–¥–µ–∂–¥—É
    (5, 3, 9, 3, 1999.99),    -- –§—É—Ç–±–æ–ª–∫–∞ x3
    (6, 3, 10, 1, 4999.99);   -- –î–∂–∏–Ω—Å—ã

-- –û–±–Ω–æ–≤–ª—è–µ–º –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –¥–ª—è orderitem  
SELECT setval('orderitem_id_seq', (SELECT MAX(id) FROM orderitem));

-- –§–∏–∫—Å–∏—Ä—É–µ–º —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é
COMMIT;

-- =====================================================
-- –°–¢–ê–¢–ò–°–¢–ò–ö–ê –ó–ê–ì–†–£–ñ–ï–ù–ù–´–• –î–ê–ù–ù–´–•  
-- =====================================================

DO $$
BEGIN
    RAISE NOTICE '';
    RAISE NOTICE 'üéâ –¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ —É—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω—ã!';
    RAISE NOTICE '';
    RAISE NOTICE 'üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:';
    RAISE NOTICE '   üìÇ –ö–∞—Ç–µ–≥–æ—Ä–∏–π: %', (SELECT COUNT(*) FROM categories);
    RAISE NOTICE '   üì¶ –¢–æ–≤–∞—Ä–æ–≤: %', (SELECT COUNT(*) FROM nomenclature);  
    RAISE NOTICE '   üîó –°–≤—è–∑–µ–π —Ç–æ–≤–∞—Ä-–∫–∞—Ç–µ–≥–æ—Ä–∏—è: %', (SELECT COUNT(*) FROM nomenclature_categories);
    RAISE NOTICE '   üë• –ö–ª–∏–µ–Ω—Ç–æ–≤: %', (SELECT COUNT(*) FROM client);
    RAISE NOTICE '   üõí –ó–∞–∫–∞–∑–æ–≤: %', (SELECT COUNT(*) FROM "order");
    RAISE NOTICE '   üìã –ü–æ–∑–∏—Ü–∏–π –∑–∞–∫–∞–∑–æ–≤: %', (SELECT COUNT(*) FROM orderitem);
    RAISE NOTICE '';
END $$;